#######
#
# Configuration file for SignalResonanceMassWindow MxAODs
# - for use with HH2yybbAnalysis-00-02-10-03
#
#######


##################################
# Job steering setup

OutputDir:        HH2yybbAnalysis_DATE
SampleName:       sample
InputFileList:    input_data.txt
BaseConfig:       HGamAnalysisFramework/HGamRel20.config

##################################
# Changes from HH2yybb/HH2yybbAnalysis.cfg
HH2yybb.Scaling.doBBToHiggs:                     NO

#######
#
# Configuration file for HH2yybbAnalysis
#
#######


##################################
# Job steering setup

OutputDir:        HH2yybbAnalysis_DATE
SampleName:       sample
BaseConfig:       HGamAnalysisFramework/HGamRel20.config
Include:          HGamAnalysisFramework/MCSamples.config

xAODBranchAccessMode:                            YES

#See MCSamples.config for isAFII options
IsAFII:                                          YES
Is50ns:                                          NO

##################################
# HgammaAnalysis setup

HgammaAnalysis.PrintConfig:                    NO

HH2yybb.Starting.Weight:                       1.0
HgammaAnalysis.ForcePileupWeightCalc:          YES
#Normalisation (This is disabled if we do not have an MxAOD as input)
HH2yybb.NormaliseToXsec:                       NO
IntegratedLuminosity_fbInv:                    4.0

##################################
# Event selection settings

EventHandler.CheckDalitz:                      YES
EventHandler.CheckDuplicates:                  YES
EventHandler.CheckGRL:                         YES
EventHandler.CheckTile:                        YES
EventHandler.CheckLAr:                         YES
EventHandler.CheckCore:                        YES
EventHandler.CheckVertex:                      YES

EventHandler.CheckTriggers:                    YES
EventHandler.RequiredTriggers:                 HLT_2g20_tight HLT_g35_loose_g25_loose HLT_g35_medium_g25_medium
EventHandler.CheckTriggerMatching:             NO

##################################
# Photon calibration & smearing settings

HH2yybb.MyyWindow.Low:                           105.0
HH2yybb.MyyWindow.High:                          160.0
PhotonHandler.Selection.ApplyAmbiguityCut:       YES
PhotonHandler.Selection.ApplyPIDCut:             YES
PhotonHandler.Selection.ApplyIsoCut:             YES
PhotonHandler.Selection.IsoCriteria:             Cone20 Cone20Higgs Cone40 Cone40CaloOnly

HH2yybb.PhotonSelection.UseFakePhotons:          NO
HH2yybb.PhotonSelection.DefaultFakeProb:         0.02957
HH2yybb.PhotonSelection.FakeProbFit.p0:          0.04859
HH2yybb.PhotonSelection.FakeProbFit.p1:          -0.0005282

#Sideband defined as |myy - mh| > width [GeV]
HH2yybb.SideBand.Width:                          5.0
HH2yybb.HiggsMassValue:                          125.0

##################################
# Electron calibration & smearing settings


##################################
# Muon calibration & smearing settings

# Basic selection criteria
MuonHandler.Selection.PID:                       Medium
MuonHandler.Selection.MaxEta:                    2.5

MuonHandler.Selection.ApplyPtCut:                YES
MuonHandler.Selection.PtCutGeV:                  4.0

MuonHandler.Selection.ApplyIPCuts:               YES
MuonHandler.Selection.d0Max:                     1.0
MuonHandler.Selection.z0Max:                     10.0

##################################
# Jet calibration

# Basic selection criteria
JetHandler.Selection.MaxAbsRapidity:             4.4
JetHandler.Selection.PtPreCutGeV:                25.0
JetHandler.Selection.CutLevel:                   LooseBad
JetHandler.Selection.JVF:                        -1
JetHandler.Selection.JVT:                        0.64

# BTagging
JetHandler.EnableBTagging:                       YES
JetHandler.BTagging.MaxAbsRapidity:              2.5

JetHandler.BTagging.TaggerNames:                 MV2c20

JetHandler.MV2c20.Efficiencies:                  60     70      77      85
JetHandler.MV2c20.OperatingPoints:               0_4496 -0_0436 -0_4434 -0_7887

HH2yybb.Selection.UseWorkingPoint:               MV2c20_85

# BJet Category
HH2yybb.Category.0BJet:                          YES
HH2yybb.Category.1BJet:                          YES
HH2yybb.Category.2BJet:                          YES

# 1 Tag Cat (not recommended)
HH2yybb.doHiggsPairing:                          NO

# BJet Response
HH2yybb.Category.JetResponse:                    NO

# BJet Selections
HH2yybb.LeadingBJet.EtaCut:                      2.5
HH2yybb.LeadingBJet.PtCut:                       55.0
HH2yybb.SubLeadingBJet.EtaCut:                   2.5
HH2yybb.SubLeadingBJet.PtCut:                    35.0

#Do BJet Muon Correction (Default is closest Muon)
HH2yybb.doJetMuonCorrection:                     YES
HH2yybb.addAllMuonsToJets:                       NO
HH2yybb.saveJetMuonCorrection:                   NO
HH2yybb.MuonJetP4Correction.DeltaR:              0.4
HH2yybb.MuonJetP4Correction.MinMuonPt:           4.0

# BB Selections
HH2yybb.MbbWindow.Low:                           95.0
HH2yybb.MbbWindow.High:                          135.0

# BJet scaling
#HH2yybb.Scaling.doBBToHiggs:                     YES
HH2yybb.Scaling.doResponseScaling:               NO
HH2yybb.Scaling.Response.Type:                   2D
HH2yybb.Scaling.Response.BJetScalingFile:        HH2yybb/BJetScaleVals.root

#Which variables are saved before scaling (bb,yybb are saved before and after by default)
HH2yybb.Variables.PreScaleJet:                   pt.m


############
# Truth Category
HH2yybb.Category.Truth:                          NO

############
# Systematics
HH2yybb.Systematics.applySystematics:            NO

############
# What to save in the output MxAOD
HH2yybb.saveMxAOD:                               NO

# Save containers (If you wish to use the MxAOD as an input to this framework the below must be set to YES)
HH2yybb.saveContainer.Jets:                      YES
HH2yybb.saveContainer.Photons:                   YES
HH2yybb.saveContainer.Muons:                     YES
HH2yybb.saveContainer.Electrons:                 YES

# What to save in the output MxAOD
MxAOD.Variables.Photon:            pt.eta.phi.m.eta_s2.relEreso.conversionType.conversionRadius.ptcone20.topoetcone20.ptcone40.topoetcone40.isEMTight.isEMTight_nofudge.isTight.isTight_nofudge.isIsoFixedCutTightCaloOnly.isIsoFixedCutTight.isIsoFixedCutLoose.truthType.truthOrigin
MxAOD.Variables.Jet:               pt.eta.phi.m.DetectorEta.Jvt.MV2c20_60.SF_MV2c20_60.MV2c20_60_Eff.MV2c20_70.SF_MV2c20_70.MV2c20_70_Eff.MV2c20_77.SF_MV2c20_77.MV2c20_77_Eff.MV2c20_85.SF_MV2c20_85.MV2c20_85_Eff
MxAOD.Variables.Electron:          pt.eta.phi.m.eta_s2.ptvarcone20.topoetcone20
MxAOD.Variables.Muon:              pt.eta.phi.m.ptvarcone20.topoetcone20.passIPCut
MxAOD.Variables.EventInfo:         runNumber.eventNumber.lumiBlock.averageInteractionsPerCrossing.eventTypeBitmask.mcChannelNumber.mcEventWeights.RandomRunNumber
MxAOD.Variables.TruthPhotons:      px.py.pz.e.m.pt.eta.etcone20.etcone40.ptcone20.ptcone40.isIsolated.truthType.truthOrigin
MxAOD.Variables.TruthElectrons:    px.py.pz.e.m.pt.eta
MxAOD.Variables.TruthMuons:        px.py.pz.e.m.pt.eta
MxAOD.Variables.TruthJets:         pt.eta.phi.m.pt.eta
MxAOD.Variables.TruthHiggsBosons:  px.py.pz.e.m.pt.eta

#
###############
